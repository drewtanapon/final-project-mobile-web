<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#0000FF" />
    <meta name="description" content="User Dashboard Page" />
    <title>‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô</title>
    <link rel="stylesheet" href="index.css" />
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script> 
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f8ff;
            color: #000066;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 100%;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px #888888;
        }
        h1 {
            color: #0000cc;
            text-align: center;
        }

        /* ‡∏õ‡∏£‡∏±‡∏ö Layout Header */
        .header {
            display: flex;
            justify-content: space-between; /* ‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î + ‡∏õ‡∏∏‡πà‡∏°‡∏Ç‡∏ß‡∏≤‡∏™‡∏∏‡∏î */
            align-items: center;
            margin-bottom: 20px;
            padding: 10px;
            border-bottom: 2px solid #ddd;
        }

        /* ‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¢‡∏π‡πà‡∏ã‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î */
        .user-info-container {
            display: flex;
            align-items: center; /* ‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÅ‡∏ô‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô */
            gap: 10px; /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
        }

        /* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏ä‡∏∑‡πà‡∏≠ + ‡∏≠‡∏µ‡πÄ‡∏°‡∏•) */
        .user-details {
            display: flex;
            flex-direction: column;
        }

        .user-info {
          display: flex;
          gap: 5px;
          font-size: 16px;
          margin: 0;
        }

        /* ‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏ß‡∏≤‡∏™‡∏∏‡∏î */
        .user-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        button {
            background-color: #0000cc;
            color: white;
            border: none;
            padding: 10px 15px;
            cursor: pointer;
            border-radius: 5px;
            text-align: center;
        }

        button:hover {
            background-color: #000099;
        }
        /* ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡∏∏‡πà‡∏° "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏ä‡∏≤" ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏ß‡∏≤‡∏™‡∏∏‡∏î */
        .add-subject-container {
            display: flex;
            justify-content: flex-end; /* ‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡πÑ‡∏õ‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏ß‡∏≤‡∏™‡∏∏‡∏î */
        }

        .add-subject {
            background-color: #008000;
        }

        .subject-list {
            text-align: left;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .subject-list ul {
            list-style-type: none;
            padding: 0;
            width: 100%;
        }

        .subject-list li {
            background: #e0ebff;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .manage-classroom button {
            background-color: #ff8c00;
        }

        .manage-classroom button:hover {
            background-color: #e07b00;
        }

        .profile-img {
          width: 60px; /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ */
          height: 60px;
          border-radius: 50%;
          object-fit: cover;
          border: 2px solid #ddd;
        }
    </style>
    <script>
        function toggleLogin() {
            const loginButton = document.getElementById("login-btn");
            if (loginButton.innerText === "Login") {
                window.location.href = "login.html";
            } else {
                loginButton.innerText = "Login";
                alert("‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß!");
                window.location.href = "login.html";
            }


        }
    </script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
          <!-- üîπ ‡∏ã‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î: ‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå + ‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏≠‡∏µ‡πÄ‡∏°‡∏• -->
          <div class="user-info-container">
              <img class="profile-img" src="logo192.png" alt="‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå">
              <div class="user-details">
                  <p class="user-info">
                      <strong>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:</strong> <span id="user-name">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span>
                  </p>
                  <p class="user-info">
                      <strong>‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:</strong> <span id="user-email">-</span>
                  </p>
              </div>
          </div>
      
          <!-- üîπ ‡∏Ç‡∏ß‡∏≤‡∏™‡∏∏‡∏î: ‡∏õ‡∏∏‡πà‡∏° "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß" ‡πÅ‡∏•‡∏∞ "Logout" (‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á) -->
          <div class="user-actions">
              <button>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</button>
              <button id="login-btn" onclick="toggleLogin()">Logout</button>
          </div>
        </div>

        <h2 style="text-align: center;">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ô</h2>

        <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏ß‡∏≤‡∏™‡∏∏‡∏î -->
        <div class="add-subject-container">
            <button class="add-subject">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏ä‡∏≤</button>
        </div>

        <!-- ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ô -->
        <div class="subject-list">
            <ul>
                <li>
                    <span>‡∏ß‡∏¥‡∏ä‡∏≤ 1</span>
                    <div class="manage-classroom">
                        <button>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
                    </div>
                </li>
                <li>
                    <span>‡∏ß‡∏¥‡∏ä‡∏≤ 2</span>
                    <div class="manage-classroom">
                        <button>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
                    </div>
                </li>
                <li>
                    <span>‡∏ß‡∏¥‡∏ä‡∏≤ 3</span>
                    <div class="manage-classroom">
                        <button>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
                    </div>
                </li>
            </ul>
        </div>
    </div>  
    <script>
      // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Firebase
      const firebaseConfig = {
        apiKey: "AIzaSyAPOWp35o6ubJy0SE_PlAqimqa1-siXfVk",
        authDomain: "webmobileapplication-cdaaf.firebaseapp.com",
        projectId: "webmobileapplication-cdaaf",
      };
      firebase.initializeApp(firebaseConfig);

      //const db = firebase.firestore();

      firebase.auth().onAuthStateChanged((user) => {
            if (user) {
              console.log("User logged in: ", user);
              
              // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å providerData ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Ñ‡πà‡∏≤
              const providerData = user.providerData[0] || {};
              const displayName = user.displayName || providerData.displayName || "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏";
              const email = user.email || providerData.email || "-";
                // ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
              document.getElementById("user-name").innerText = user.displayName || "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏";

              // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏î‡πâ‡∏ß‡∏¢ Email ‡∏´‡∏£‡∏∑‡∏≠ OTP
              if (user.email) {
                  document.getElementById("user-email").innerText = user.email;
              } else {
                  document.getElementById("user-email").innerText = "-"; // ‡∏Å‡∏£‡∏ì‡∏µ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏î‡πâ‡∏ß‡∏¢ OTP
              }
            } else {
                document.getElementById("user-name").innerText = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô";
                document.getElementById("user-email").innerText = "-";
            }
      });

      function toggleLogin() {
            firebase.auth().signOut().then(() => {
                window.location.href = "login.html"; // ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Login
            }).catch((error) => {
                console.error("Logout Error:", error);
            });
        }

      // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Firestore
      function fetchSubjects() {
          const subjectList = document.getElementById("subject-list");
          subjectList.innerHTML = ""; // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°

          db.collection("subjects").get().then((querySnapshot) => {
              if (querySnapshot.empty) {
                  subjectList.innerHTML = "<li>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ß‡∏¥‡∏ä‡∏≤</li>";
                  return;
              }
              
              querySnapshot.forEach((doc) => {
                  const subject = doc.data();
                  const li = document.createElement("li");
                  li.innerHTML = `
                      <span>${subject.name}</span>
                      <button onclick="manageClass('${doc.id}')">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
                  `;
                  subjectList.appendChild(li);
              });
          }).catch((error) => {
              console.error("Error fetching subjects: ", error);
              subjectList.innerHTML = "<li>‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</li>";
          });
      }

      function manageClass(subjectId) {
          alert("‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏¥‡∏ä‡∏≤ ID: " + subjectId);
      }

      // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
      window.onload = fetchSubjects;
    </script>
</body>
</html>